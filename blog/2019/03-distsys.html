<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.4">
<meta name="author" content="2019-01-14">
<title>Высокая доступность: концепции и применимость</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove comment around @import statement below when using as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
body{-webkit-font-smoothing:antialiased}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.spread{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
body{tab-size:4}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}
@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}
.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}
@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}
.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0;line-height:1.45}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1em;font-size:.85em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{width:1em;position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;text-indent:-1.05em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Высокая доступность: концепции и применимость</h1>
<div class="details">
<span id="author" class="author">2019-01-14</span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_Концепции">Концепции</a>
<ul class="sectlevel2">
<li><a href="#_Основы">Основы</a></li>
<li><a href="#_cap_теорема">CAP теорема</a></li>
<li><a href="#_Модели_консистентности">Модели консистентности</a></li>
<li><a href="#_acid">ACID</a></li>
<li><a href="#_base">BASE</a></li>
<li><a href="#_pacelc">PACELC</a></li>
<li><a href="#_conway_s_law">Conway&#8217;s law</a></li>
</ul>
</li>
<li><a href="#_Избыточность">Избыточность</a>
<ul class="sectlevel2">
<li><a href="#_active_active">Active-Active</a></li>
<li><a href="#_replica_set">Replica Set</a></li>
<li><a href="#_Аварийное_переключение_failover_стратегии_и_практики">Аварийное переключение (failover), стратегии и практики</a></li>
<li><a href="#_Управление_отказами">Управление отказами</a></li>
</ul>
</li>
<li><a href="#_sla_slo_sli">SLA, SLO, SLI</a>
<ul class="sectlevel2">
<li><a href="#_sli_slo_sli">SLI &#8594; SLO &#8594; SLI</a></li>
<li><a href="#_sla_slo_sli_2">SLA, SLO, SLI</a></li>
</ul>
</li>
<li><a href="#_Ключевые_подходы_для_построения_систем_высокой_доступности">Ключевые подходы для построения систем высокой доступности</a>
<ul class="sectlevel2">
<li><a href="#_Не_экономить_на_самом_дешевом_железе">Не экономить на самом дешевом железе</a></li>
<li><a href="#_Ответственность">Ответственность</a></li>
<li><a href="#_Устранение_единых_точек_отказа_single_point_of_failure_spof">Устранение единых точек отказа (Single Point of Failure (SPOF))</a></li>
<li><a href="#_Консолидация_серверов">Консолидация серверов</a></li>
<li><a href="#_Автоматизация_и_оптимазиация">Автоматизация и оптимазиация</a></li>
<li><a href="#_Типовые_конфигурации_и_общие_репозитории">Типовые конфигурации и общие репозитории</a></li>
<li><a href="#_Измерение_производительности">Измерение производительности</a></li>
<li><a href="#_Обучение_и_тренинги_персонала">Обучение и тренинги персонала</a></li>
<li><a href="#_Раздельные_контуры">Раздельные контуры</a></li>
</ul>
</li>
<li><a href="#_Ссылки">Ссылки</a></li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="_Концепции">Концепции</h2>
<div class="sectionbody">
<div class="paragraph">
<p>В прошлых статьях рассмотрели причины сбоев, типичный таймлайн сбоев, какие фазы там есть и какие действия обычно требуются, что бы вернуть систему в стабильное рабочее состояние. Настало время погружаться в теорию HA глубже, но попытаться не распыляться на конкретные компоненты и решения, чтобы сохранить универсальность и иметь возможность применять их безотносительно частных случае и реализаций.</p>
</div>
<div class="paragraph">
<p>И так, проектируя HA систему, прежде всего преследуют цель построить систему, которая бы за минимальные деньги держала определенную нагрузку и лишний раз не беспокоила (что в принципе тоже деньги). Соответственно система должна быть:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Надежной:</strong> минимальный потенциал для сбоев.</p>
</li>
<li>
<p><strong>Избыточной:</strong> использовать имеющиеся ресурсы, чтобы продолжать работать даже после сбоя без внешнего вмешательства.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>И уже тут начинаются противоречия. Чем меньше компонентов в системе и их связанность - тем она надежней, но при увеличении избыточности увеличивается и связанность, а количество сбоев в системе растет. Почему так - рассмотрим в последующей статье - <a href="04-distsys.html">Высокая доступность: надёжность компонентов и систем</a>.</p>
</div>
<div class="paragraph">
<p>В предыдущей статье был приведён пример расчёта влияния увеличения доступности на выручку, получаемую организацией. В подходах обеспечения HA для системы или её части следует поступать аналогичным образом, то есть доставлять доступность как новую функцию с некоторой ценностью для бизнеса и с возможность посчитать её ROI. Тем самым доступность системы будет находиться в соответствии с потребностями бизнеса, его планами и возможностями. А обоснование работ, критерии достижимости и средства будут понятны и для владельцев продукта, и для исполнителей.</p>
</div>
<div class="paragraph">
<p>Упрощенная схема влияния доступности на выручку:<br>
<span class="image"><img src="./03-distsys/impact_of_availability.png" alt="Влияние доступности на выручку и затраты"></span></p>
</div>
<div class="paragraph">
<p>При такой простой мотивации поступают также просто:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>анализируется текущий дизайн системы на возможные отказы;</p>
</li>
<li>
<p>составляется список сценариев отказа;</p>
</li>
<li>
<p>для каждого сценария указывается вероятность отказа и урон им созданный;</p>
</li>
<li>
<p>наиболее важные сценарии для бизнеса фиксируются в требованиях;</p>
</li>
<li>
<p>проектирование решений по преодолению этих сценариев, оценивается стоимость реализации;</p>
</li>
<li>
<p>ревью решений, проверка гипотез по преодолению отказов;</p>
</li>
<li>
<p>реализация.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Потребность в высокой доступности может быть вызвана не только увеличением прибыли и уменьшения рисков, но и для соответствия определенным отраслевым и государственным стандартам и регламентам.</p>
</div>
<div class="sect2">
<h3 id="_Основы">Основы</h3>
<div class="paragraph">
<p>Отказоустойчивые системы, а значит системы с некоторой избыточностью, также являются подгруппой распределенных систем. При работе с ними инженеры иногда забывают о фундаментальных ограничениях или по привычке используют упрощенные модели, L. Peter Deutsh сформировал список из таких <strong>заблуждений</strong> в распределенных вычислениях:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Сеть надёжна.</p>
</li>
<li>
<p>Задержка (latency) сети равна нулю.</p>
</li>
<li>
<p>Пропускная способность бесконечна.</p>
</li>
<li>
<p>Сеть безопасна.</p>
</li>
<li>
<p>Топология не меняется.</p>
</li>
<li>
<p>Только один администратор.</p>
</li>
<li>
<p>Затраты времени на передачу равны нулю.</p>
</li>
<li>
<p>Сеть гомогенная.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Дополнение и объяснение этих заблуждений будет выходить за рамки данной статьи, но Вы сможете найти больше информации в публикации <a href="http://www.rgoarchitects.com/Files/fallacies.pdf">Fallacies of Distributed Computing: Explained</a> от архитектора Arnon Rotem-Gal-Oz.</p>
</div>
</div>
<div class="sect2">
<h3 id="_cap_теорема">CAP теорема</h3>
<div class="paragraph">
<p>В этих заблуждениях упомянули, что задержка по сети не равна нулю, что пропускная способность не бесконечна, что сама сеть не надёжна. В следствии того, что информация не может распространяться по разным узлам сети мгновенно и в любом объеме, спровоцировало появление большого количества моделей управления данными в распределенных системах, а на основе них появилась CAP теорема <a href="#cap">[cap]</a>. Поверхностные детали теоремы рассматривать не будем, так как интуитивно простые, статьи с Wikipeda достаточно. Сложность как обычно в деталях, а именно <strong>моделях консистентности</strong>, которые будут влиять на такие характеристики системы как: латентность, пропускная способность, величину RPO, способ решения проблем конкурентности.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Модели_консистентности">Модели консистентности</h3>
<div class="paragraph">
<p>Существует довольно большое множество моделей консистентности, которые описывают различные подходы при работе с данными в распределенной системе и естественно с больше чем одним агентом которые с ними работают. Так как статья посвящена высокодоступным системам, то мы подразумеваем, что клиенты получают доступ к сервису без ожиданий и попыток синхронизироваться друг с другом, то есть система работоспособна даже тогда, когда доступен остался лишь один узел. Это называется <code>wait-free</code> атрибут распределенной системы. В следствии наличия wait-free атрибута приходится раскрывать сам факт конкурентности доступа к данным в такой системе. Так бизнес диктует свои потребности с некоторой областью возможностей, то при проектировании системы и мы может выбирать в каких случаях и как организовать проведение транзакций. Транзакций не в терминах СУБД, а в терминах предметной области, что важно.</p>
</div>
<div class="paragraph">
<p>И так, выбираем между абсолютно строгим подходом доступа к данным и состоянием постоянной неконсистентности на узлах. Более формально: самый строгий способ достижения консистентности - использовать лишь один объект с данными и организовать последовательный доступ к нему, ни о каком wait-free там естественно речи быть не может в случае более одного клиента. Ослаблять требования этого способа можем через смягчающий критерий - раскрытие деталей конкурентной работы с данным, тем самым выстраивая правила (протокол) работы с ними и тем самым допуская случаи появления неконсистентности в данных. Под протоколом подразумевается нахождение консенсуса для линеаризации проводимых транзакций и нахождения консенсусов.</p>
</div>
<div class="paragraph">
<p>Ниже представлена решетка моделей консистентности от самого слабого критерия до сильного. Граф разделён CAP границей, всё что ниже неё может использовать в wait-free системах, всё что выше - нет.</p>
</div>
<div class="paragraph">
<p>Решётка моделей консистентности<a href="#ds1e">[ds1e]</a>:
<span class="image"><img src="./03-distsys/consistancy_lattice.png" alt="Решетка консистентности"></span>
Как видно из изображения в wait-free системе могу быть реализованы: update consistency модель, eventual concistency, pipelined consistency.<br>
Отдельно хочется отметить serilizability, многие инженеры ошибочно считают, что она даст возможность забыть о проблеме консистентности проведения транзакций в распределённой системе. Она строже event consistency, но всё же не исключает проблем при разделении кластера (<a href="https://en.wikipedia.org/wiki/Split-brain_(computing)">split brain</a>), так как гарантирует проведение изолированных серий транзакций на локальных данных, а синхронизация через shared object и арбитраж. Когда отделившийся узел возвращается в кластер, он будет вынужден вернуться к состоянию в момент сплита, либо потребует операцию по слиянию данных. Такая модель позволяет реализовать хорошие показатели производительности и предоставляет отличный контроль данных. Именно в следствии этого получила столь широкое распространение и для работы с важными данными (мед. записи, банковские транзакции), но как всегда есть нюансы.</p>
</div>
<div class="paragraph">
<p>Сверху находятся модели с жесткими критериями последовательности транзакций и линеаризацией, получается не wait-free система, но данные однозначно останутся консистентными в любой момент времени. Для более более подробного знакомства с этими моделями рекомендую заглянуть в <a href="#ds1e">[ds1e]</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_acid">ACID</h3>
<div class="paragraph">
<p>Большинство с ACID должно быть знакомо в общих чертах и даже в трактовках. Если нет - есть <a href="https://en.wikipedia.org/wiki/ACID_(computer_science)">wiki: ACID_(computer_science)</a>. Продолжаем тему применимости принципов и моделей в построении HA систем. Ниже граф уровни изоляции транзакций (AC<strong>I</strong>D) на основе CAP моделей, источник <a href="#hat">[hat]</a>  (нарисовал <a href="https://twitter.com/0x0FFF/">Alexey Grischenko</a>):
<span class="image"><img src="./03-distsys/cap_map.jpeg" alt="CAP map"></span></p>
</div>
<div class="paragraph">
<p>Что это значит:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>граф - корень (Strong-1SR) - наивысший уровень "изоляции" транзакций (все транзакции последовательны), чем дальше от корня, тем ниже уровень изоляции транзакции, тем меньше нужно ресурсов на её проведение в распределённом приложении</p>
</li>
<li>
<p>красное - модель невозможно использовать в HA системе<br></p>
</li>
<li>
<p>зелёное - используется<br></p>
</li>
<li>
<p>синее - используется для тех случаев когда клиент работает лишь с один узлом, либо сам может выполнять роль сервера.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Практическое использование. В большинстве классических РСУБД по умолчанию используется serializable модель, иногда и как наиболее строгая, пример PostgreSQL <a href="#pgsql-tr">[pgsql-tr]</a>. Microsoft SQL Server <a href="#mssql-si">[mssql-si]</a>  и Oracle <a href="#oracle-si">[oracle-si]</a> позволяют повысить изоляцию до snapshot isolation.</p>
</div>
<div class="paragraph">
<p>В принципе, когда говорят про <strong>C</strong>AP и AC<strong>I</strong>D зачастую подразумевают не serializable, а linearizable консистентность. Нюанс тут в том, что большинство РСУБД используют serializable или snapshot уровни изоляции с <a href="https://en.wikipedia.org/wiki/Multiversion_concurrency_control">Multivesion concurrency control (MVCC)</a>, но не способны реализовать линеаризуемость транзакций, так как это сильно снизит скорость конкурентного доступа к данным. В этом и есть неочевидный и мало кому знакомый нюанс использования этих терминов.</p>
</div>
<div class="paragraph">
<p>Те, кто уже хорошо знаком с ACID могут обратить внимание, что сериализуемые транзакции, являющиеся "эталоном" для достижения целостности и истинности данных в принципе для большой распределенной системы не подходят из-за жестких ограничений. При большом количестве узлов требует и больших затрат ресурсов, и времени, и нет толерантности к разделению(CA<strong>P</strong>). Это и вызвало появление AP NoSQL систем таких как Amazon Dynamo, Cassandra.</p>
</div>
<div class="paragraph">
<p>Из-за вот таких не очевидных нюансов, невозможности отнести все системы к классу CA, AP, CP, потребности более точно и кратко описать системы использующие не serializable модель и появились <a href="#_base">BASE</a> и <a href="#_pacelc">PACELC</a> аббревиатуры.</p>
</div>
</div>
<div class="sect2">
<h3 id="_base">BASE</h3>
<div class="paragraph">
<p>Обязано появлением систем на основе eventual consistency, для которых приемлемо находиться в неконсистетном состоянии какое-то время и отдавать клиенту неконсистентные данные, тем самым сохраняя доступность.
BASE - <strong>B</strong>asically <strong>A</strong>vailable, <strong>S</strong>oft state, <strong>E</strong>ventual consistency. По графу моделей консистентности видно, что они не такие жесткие как системы на serializable модели.
Пример BASE-баз данных: CouchDB, Amazon SimpleDB, Amazon Dynamo, Riak.</p>
</div>
</div>
<div class="sect2">
<h3 id="_pacelc">PACELC</h3>
<div class="paragraph">
<p>Ещё одна post-CAP теорема, а фактически её расширение. Созданное, чтобы в общую модель добавить современные NoSQL решения. Была предложена в работе "Consistency Tradeoffs in Modern Distributed Database System Design" <a href="#abadi">[abadi]</a>. Трактовка из оригинала:</p>
</div>
<div id="pacelsabadi" class="quoteblock">
<blockquote>
<div class="paragraph">
<p>A more complete portrayal of the space of potential consistency tradeoffs for DDBSs can be achieved by rewriting CAP as PACELC (pronounced “pass-elk”): if there is a partition (<strong>P</strong>), how does the system trade off availability and consistency (<strong>A</strong> and <strong>C</strong>); else (<strong>E</strong>), when the system is running normally in the absence of partitions, how does the system
trade off latency (<strong>L</strong>) and consistency (<strong>C</strong>)?</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Daniel J. Abadi
</div>
</div>
<div class="paragraph">
<p>Теперь в рамках одной теоремы можно более точно указать "классы" хранилищ и описать требования к ним. Классические ACID системы - PC/EС. Сохраняют целостность кластера (P), консистетность (С), но вынуждены жертовать доступностью и задержками ради (E) консистентности (С).
Современные NoSQL, в лице MongoDB, Amazon Dynamo, Cassandra, Aerospike являются PA/EL. То есть уcтойчивы к сплитам (P), сохраняют доступность (A), но жертвуют консистентностью, ради (E) низких задержек (L).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">NOTE</dt>
<dd>
<p>Выше преведены модели используемые по умолчанию. Большинство современных СУБД поддерживают конфигурирование уровней коснистентности, которые могут зависеть от настроек сервера, базы, сессии. Обращайте на это внимание при работе с ними, а тем более при выборе СУБД.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Для более детальной информации рекомендую всё же ознакомиться c <a href="#abadi">[abadi]</a> и заглянуть в <a href="https://en.wikipedia.org/wiki/PACELC_theorem">wikipedia</a> где приводятся классы наиболее популярных СУБД.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conway_s_law">Conway&#8217;s law</h3>
<div class="paragraph">
<p>Отдельно хочется упомянуть Conway&#8217;s Law.</p>
</div>
<div id="conwayslaw" class="quoteblock">
<blockquote>
<div class="paragraph">
<p>organizations which design systems &#8230;&#8203; are constrained to produce designs which are copies of the communication structures of these organizations.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; M. Conway
</div>
</div>
<div class="paragraph">
<p>Строя распределённую систему - формируйте команды под задачи, а не наоборот. Иначе система будет иметь теже самые проблемы, что и <a href="https://twitter.com/shanselman/status/790285272021803008">здесь</a>.</p>
</div>
<div class="paragraph">
<p>Существует множество других законов и следствий, которые прямым или косвенным образом связаны с распределенными и высокодоступными системи, но их вместить может пожалуй целая энциклопедия (например - <a href="https://www.springer.com/gp/book/9780387097657">Encyclopedia of Parallel Computing</a>), так что здесь ограничимся лишь самыми базовыми.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_Избыточность">Избыточность</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Как ранее было описано, избыточность в системе позволяет продолжить работу после сбоя и даже без потери данных. Избыточность в компонентах системы может быть на разных уровнях, всё зависит от того для какого сценария сбоя эти избыточные компоненты предназначены.
Примеры создания избыточности:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>зеркалирование дисков - RAID <a href="#wiki_raid">[wiki_raid]</a> или <strong>Redundant</strong> Arrays of Independet Disks</p>
</li>
<li>
<p>резервные блоки питания серверов</p>
</li>
<li>
<p>дополнительная сетевые интерфейсы, коммутаторы</p>
</li>
<li>
<p>резервные лини электроснабжения, питание серверов через источники бесперебойного питания</p>
</li>
<li>
<p>избыточность в кластере сервисов, обычно он называется высокодоступным кластером или HA cluster.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Если блок компонентов содержит в себе избыточность и может без внешнего вмешательства переключаться на избыточные (резервные) элементы который и возьмет на себя нагрузку.Такой компонент называется устойчивым к сбоям (fault-tolerant). Далее рассмотрим стратегии и прочие нюансы при переключении на избыточные элементы системы после сбоя, а также конфигурации отказоустойчивых кластеров.</p>
</div>
<div class="paragraph">
<p>Ниже рассмотрим самых популярных схем организации избыточности.</p>
</div>
<div class="sect2">
<h3 id="_active_active">Active-Active</h3>
<div class="paragraph">
<p>Один из самых популярных вариантов организации высокодоступных кластеров при построении Web-сервисов. Все узлы в активном использовании, балансировщи раскидывает трафик в зависимости от его политики (random, round robin,). В случае если один из узлов перестал отвечать балансировщик сам может перекинуть коннект на другой узел тем самым избежав потерю данных и с нулевым даунтаймом.
Плюсы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>уменьшение даунтайма, так как фактический узел невидим для клиента</p>
</li>
<li>
<p>эффективное использование оборудования, реализация полной его ёмкости</p>
</li>
<li>
<p>легко наращивать нагрузку</p>
</li>
<li>
<p>тестирование аварийного переключения за балансировщиком менее рискованное</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Минусы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>организация такой архитектуры сопряжена с определенными трудносятми или вообще не возможна в случае хранения состояния (сессии) на стороне сервера. Не всегда можно привязать юзеров к конкретному серверу за балансировщиком, failover также будет сопряжен с определенными проблемами.</p>
</li>
<li>
<p>возможны коллизии данных без роутинга клиентов на определенные узлы</p>
</li>
<li>
<p>следует крайне аккуратно рассчитывать запас по производительности в случае выхода из строя одного из узлов, производительность может упасть не линейно и вызвать отказ и второго узла.</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_cold_standby">Cold Standby</h4>
<div class="paragraph">
<p>Один активный компонент предоставляет нужные для системы функции. Когда случается его отказ, cold standby компонент переход в режим hot и замещает предыдущий. В системе может быть более чем два компонента, тем самым повышая её живучесть. Её плюс в том, что в такой системе деградация очевидна и скорость отказов (failure reate) константна, что упрощает оценку и прогнозирование. Практически был вытеснен, остался в legacy c монолитами.</p>
</div>
</div>
<div class="sect3">
<h4 id="_hot_standby">Hot Standby</h4>
<div class="paragraph">
<p>В этом случае standby компонент, который защищает основной также включен. Данные на standby реплицируются с секундными интервалами. В случае отказа основного компонента происходит переключение (failover) на второй, в случае успешного переключения downtime стремится или равен нулю. Но есть следующие нюансы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Из-за того, что они находятся под разной нагрузкой у них могут быть и разные скорости отказа.</p>
</li>
<li>
<p>Подразумевается, что механизм переключения абсолютно надёжен, если нет - система также подвергнется отказу</p>
</li>
<li>
<p>В случае отказа standby компонента система не затронута.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_replica_set">Replica Set</h3>
<div class="paragraph">
<p>Вариация Hot Standby, но для СУБД. Главный узел называется <code>primary</code>, остальные <code>secondary</code> Все узлы кластера проверяют друг друга на доступность по heartbeat. В случае обнаружения недоступности primary узла инициализиуют выбор нового primary и проводят failover. Secondary узлы могут использоваться как реплики для чтения, но зависит от рекомендаций конкретных СУБД.</p>
</div>
<div class="sect3">
<h4 id="_2n_избыточность_2n_redundancy">2N избыточность (2N Redundancy)</h4>
<div class="paragraph">
<p>Схема, напоминающая Hot Standby. Все избыточные юниты проверяют доступность друг друга. В случае обнаружения, что активный (эксплуатируемый) юнит недоступен инициализируют аварийное переключение (failover). Ранее была распространена в телекоме как схема увеличения надёжности через использование аналогичного железа, но различного ПО, выполняющего теже самые функции, чтобы избежать отказа всех узлов в критически важной системе с одной и той же ошибке в ПО. Сейчас подобная схема используется преимущественно в инфраструктуре датацентров для управление питанием.</p>
</div>
</div>
<div class="sect3">
<h4 id="_Трёх_компонентное_большинство_с_голосованием_triplex_duplex">Трёх-компонентное большинство с голосованием (Triplex-Duplex)</h4>
<div class="paragraph">
<p>В эксплуатации находятся три компонента, вывод от всех трёх компонентов сравнивается между собой, если один из компонентов выдаёт отличное от большинства значение, то он больше не может рассматриваться как достоверный и выводится из эксплуатации. Компоненты не подлежат ремонту во время эксплутации, только замена. Схема используется в критически важных системах: авионика, медицинские системы, системы жизнеобеспечения, индустриальные системы повышенной надёжности.</p>
</div>
</div>
<div class="sect3">
<h4 id="_n_от_m">N от M</h4>
<div class="paragraph">
<p>Обобщение предыдущей схемы, в эксплутации находится M параллельных избыточных компононентов, где N компонентов из них активны. Если один из N компонетов откажет и не будет предоставлять за определенное время корректный вывод, то он удаляется из схемы. Такая система отличается повышенной надёжностью, поскольку может пережить отказ множества компонентов оставаясь работоспособной в с их минимальным количеством.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_Аварийное_переключение_failover_стратегии_и_практики">Аварийное переключение (failover), стратегии и практики</h3>
<div class="paragraph">
<p>Для аппаратных компонентов failover обрабатывается в драйверах системы, которые предоставляет вендор вместе с железом. Нормальная обработка такого failover не вызывает прекращение работы оборудования и не вызывает перезагрузку ОС.</p>
</div>
<div class="paragraph">
<p>Если сбой происходит в кластере, миграция между сервисами внутри него должна удовлетворять следующим критериям:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>Прозрачность.</strong> Аварийное переключение не должно мешать работе клиентов, после восстановления. Так сбой у master/active узла в HA кластере должен повлечь переброс трафика на резервный standby узел (который становится active) и установление соединений от клиентов к этому серверу, после чего возобновляется их нормальная работа. Опционально возможно выполнение повторных процедур аутентификации.</p>
</li>
<li>
<p><strong>Время переключения.</strong> В идеале не должно приводить к длительной остановке зависимого клиента. Так например в HA <code>replica set</code> кластерах c небольшим количеством узлов secondary узлы через определенные промежутки времени опрашивают primary, если он недоступен, то выбирают (election) новый primary узел, который и принимает на себя клиентов или управляет взаимодействием с ними. Период времени (heartbeat rate) между опросами обычно настраиваемый и не больше двух минут. Таким образом, клиент, потеряв соединение с primary (по его таймауту), пытается соединиться с каким-нибудь другим узлом из кластера, который можно было бы идентифицировать как новый primary. В этом случае согласованно и рационально настроенные таймаут соединений, hearbeat rate и на клиенте имеются retry политики и backpessure подход (о них позже), то переключение на новый primary сервер должно занять максимум несколько минут и не привести к потере данных для клиента.</p>
</li>
<li>
<p><strong>Автоматизация.</strong> Переключение на избыточный узел желательно осуществлять в автоматическом режиме, для того, чтобы способствовать уменьшению MTTR. Если внутри кластера сервера имеют разные статусы, то механизм выбора главного сервера также должен запускаться автоматически.</p>
</li>
<li>
<p><strong>Гарантированный доступ к предоставляемому сервису.</strong> После аварийного переключения клиент должен иметь доступ к тем же самым данным (но есть нюансы в виде консистентности данных на различных узлах) и тем же самым сервисам, которые предоставлялись прошлым сервером в этом кластере.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_Управление_отказами">Управление отказами</h3>
<div class="paragraph">
<p>Вкратце:
<span class="image"><img src="./03-distsys/fault_management.jpg" alt="242" width="540" height="Fault management"></span></p>
</div>
<div class="paragraph">
<p>Современные agile подходы с короткими циклами релизов, CI/CD практики и прочий Ops-инструментарий очень сильно упростили работу с отказами, позволяя эксплутарировать большие системы существенно меньшим количеством людей.</p>
</div>
<div class="paragraph">
<p>Чек лист для занятых эксплутацией и дизайном систем:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>healt-check сервисов</p>
</li>
<li>
<p>сбор логов</p>
</li>
<li>
<p>регулярное сканирование сети и проверка топологии</p>
</li>
<li>
<p>политики доступов как для сотрудников, так и для самих сервисов</p>
</li>
<li>
<p>сбор метрик</p>
</li>
<li>
<p>определение пороговых значений (thresholds) для выше обозначенных метрик</p>
</li>
<li>
<p>оповещения для администраторов, сотрудников поддержки занятых в эксплутации, инцидент- трекинг сервис (PageDuty, VictorOps)</p>
</li>
<li>
<p>использование трейсинга, в том числе распределенной системы</p>
</li>
<li>
<p>автоматизация обработки отказов</p>
</li>
<li>
<p>организация дежурств, уровней саппорта, политик экскалаций</p>
</li>
<li>
<p>журнал post-mortem с отчётами о развитии крупных отказов, описание поиска решения, что сделано, чтобы предотвратить в будущем.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_sla_slo_sli">SLA, SLO, SLI</h2>
<div class="sectionbody">
<div class="paragraph">
<p>(Fig. 2.2. Service level agreements (SLAs) and user notion of availability)
Есть несколько подходов по работе с документами связанными с доступностью системы. Различие в них не концептуальные, по связанные с бизнес-моделью организации и внутренними процессами.</p>
</div>
<div class="hdlist">
<table>
<tr>
<td class="hdlist1">
Service Level Agreement (SLA)
</td>
<td class="hdlist2">
<p>договоренность об уровне сервиса (см. <a href="#availability-math">Математика доступности</a>)</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Service Level Objectives (SLO)
</td>
<td class="hdlist2">
<p>цели по предоставлению уровня сервиса (внутренние требования (документы)), является более строгим набором требований чем SLA, так как нарушение последнего может привести к явным финансовым и репутационным потерям.</p>
</td>
</tr>
<tr>
<td class="hdlist1">
Service Level Indicators (SLI)
</td>
<td class="hdlist2">
<p>метрики доступности системы</p>
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_sli_slo_sli">SLI &#8594; SLO &#8594; SLI</h3>

</div>
<div class="sect2">
<h3 id="_sla_slo_sli_2">SLA, SLO, SLI</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="_Ключевые_подходы_для_построения_систем_высокой_доступности">Ключевые подходы для построения систем высокой доступности</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Если вы желаете увеличить доступность системы для внешних пользователей, всегда начинайте анализ с самого верхнего уровня, чтобы не оказаться в ситуации, когда балансировщик трафика с отказоустойчивым кластером стоит за каким-то жалким единственным роутером, который работает лишь по стечению случайностей. Всегда эту проблему необходимо рассматривать именно со стороны пользователя системы или сервиса, который к ней обращается, а не изнутри.</p>
</div>
<div class="sect2">
<h3 id="_Не_экономить_на_самом_дешевом_железе">Не экономить на самом дешевом железе</h3>
<div class="paragraph">
<p>Выбирать железо стоит исходя не только из его минимальной цены за определенные возможности, а по результатам расчёта ROI где учитывается его непосредственная цена, его время эксплуатации в системе, наличие специалистов для его обслуживания, гарантийного сервиса и близость поставщиков для его замены по гарантии или для обновления.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Ответственность">Ответственность</h3>
<div class="paragraph">
<p>Ни вендор, ни поставщик программного обеспечения, ни программисты не могут построить высокодоступную и комфортную для пользователя системы. Построение такой системы это тестирование, интеграция, испытания, верификация приложений и рабочих процессов. Наивно подразумевать, что развернув определенное ПО на рабочем контуре вы получите высокодоступную систему, так как это: максимальный MTBF и минимальный MTTR, которые доводятся до нужных значений именно отладкой рабочих процессов сотрудников. Не стоит уповать и на организацию кластеров и средства репликации данных. Без своевременных вмешательств и организации работ по выводу из состоянии деградации система не может быть отказоустойчивой и высокодоступной. Формируйте SLA, SLO, ведите SLI.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Устранение_единых_точек_отказа_single_point_of_failure_spof">Устранение единых точек отказа (Single Point of Failure (SPOF))</h3>
<div class="paragraph">
<p>Анализируйте систему на присутствие в ней элементов, выход из стоя которых может привести к невозможности продолжить исполнение даже в ограниченном режиме. Проще всего начать с анализа цепочек исполнения, зависимостей или data-flow диаграмм. Достаточно пройтись по ключевым обслуживаемым процессам, чтобы уже появилось представление о самых слабых узлах в цепочке. Но далеко не каждый компонент, представляющий собой SPOF, возможно дублировать или устранить, иногда по финансовым причинам (слишком дорогое дублирующее железо), ограничения физические (например только один вводной канал) или концептуальное ограничение (например CAP-теорема<a href="#cap">[cap]</a>)</p>
</div>
</div>
<div class="sect2">
<h3 id="_Консолидация_серверов">Консолидация серверов</h3>
<div class="paragraph">
<p>Вместо использования множества мелких серверов, иногда имеет смысл использовать лишь несколько, но гораздо более мощных для того, чтобы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>упростить топологию и уменьшить количество узлов</p>
</li>
<li>
<p>сократить затраты на обслуживание (обновление, резервное копирование и т.п.)</p>
</li>
<li>
<p>улучшить производительность из-за уменьшения затрат на передачу данных по сети</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Инструментарий для виртуализации и оркестрацией серверов упрощает управление распределенной инфраструктурой, еще и с прослойкой абстракции над железом, но для части задач (такие как базы данных) или большие legacy системы, всё ещё имеет смысл.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Автоматизация_и_оптимазиация">Автоматизация и оптимазиация</h3>
<div class="paragraph">
<p>Чем выше уровень автоматизации - тем меньше требуется время на операции, меньше отвественных за них. Ускорение и автоматизация цикла "сборка-тестирование" добавляет удобства для инженеров, увелчивает количество таких циклов за единицу времени, время тратится более эффективно. СI/CD подходы сильно упрощают раскатывание новых релизов по контурам, тем самым уменьшая и MTTR, и time to market (TTM).</p>
</div>
</div>
<div class="sect2">
<h3 id="_Типовые_конфигурации_и_общие_репозитории">Типовые конфигурации и общие репозитории</h3>
<div class="paragraph">
<p>Унификация сильно помогает для уменьшения времени на проектирование, тестирование и развертывание новых сервисов. Общие конфигурации и артефакты сильно помогают в этом на всех стадиях от идентификации потребности, до развертывания в production.
Чек-лист:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>список рекомендованного ПО для production</p>
</li>
<li>
<p>репозиторий скриптов развертывания инфраструктуры - Infrastructure as Code</p>
</li>
<li>
<p>репозиторий артефактов (Artifactory, Bintray, GitLab)</p>
</li>
<li>
<p>реестр типовых образов (Docker Registry, Amazon ECR, GitLab Container Registry)</p>
</li>
<li>
<p>типовые шаблоны для security groups</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_Измерение_производительности">Измерение производительности</h3>
<div class="paragraph">
<p>Рассуждая о доступности какого-то сервиса для клиента, мы имеем ввиду, что <strong>все</strong> компоненты в цепочке исполнения должны иметь время реакции из конкретного временного интервала, иначе уровень сервиса для клиента может упасть до неприемлемо низких значений. Чтобы не столкнуться с непредвиденной деградацией производительности в поддержании высокодоступной системы должны быть использованы:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#wiki_bm">бенчмаркинг</a> отдельных компонентов системы</p>
</li>
<li>
<p>нагрузочное или стресс тестирование - подача нагрузки на систему или её изолированную часть и замеры, чтобы определить граничные возможности системы обработать выданную нагрузку. Качество проводимого тестирования сильно зависит от возможности эмулировать паттерн нагрузки как и на боевой системе, организации замеров.</p>
</li>
<li>
<p>сбор и анализ метрик производительности во время эксплуатации, могут быть как системные метрики, так и из предметной области.</p>
</li>
<li>
<p>stability testing - продолжительное по времени тестирование, проводимое с симуляцией различных условий эксплуатации.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Результаты тестирования сохраняются с указанием версии ПО или железа, чтобы в будущем иметь возможности системы от релиза к релизу. Помогает выявить внесённые изменения, повлекшие к деградации производительности.</p>
</div>
<div class="paragraph">
<p>Последовательные и систематичные меры дадут возможность не только видеть состояние системы под нагрузкой, понимать границы той самой доступности предоставляемого сервиса, но и видеть причинно-следственные связи от изменений в самой системе или её реакцию на изменение нагрузки. Чем более похожая будет нагрузка тестовая, тем ближе будет соответствие результатам в эксплуатации. Кроме того, обладая данными о фактической производительности компонентов появляется возможность более точно рассчитать потребности в ресурсах при горизонтальном масштабировании.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Обучение_и_тренинги_персонала">Обучение и тренинги персонала</h3>
<div class="paragraph">
<p>Обучайте людей пользоваться инструментами, рассказывайте об их возможностях влиять на систему, какова их роль в процессе и за что отвечают. Занятый в эксплуатации человек будет действовать более уверенно и быстро, когда он знает о своих возможностях.</p>
</div>
</div>
<div class="sect2">
<h3 id="_Раздельные_контуры">Раздельные контуры</h3>
<div class="paragraph">
<p>Чтобы процессы разрабокти и тестирования не влияли на саму эксплутатируемую систему необходимо разделять среды с различной их целью. Обычно используются следующие:
* sandbox для разработчиков где тестируется новый софт, технологии, железо
* dev контур для работы над кодом, dev-тестирования, если невозможно развернуть систему для теста на локальном компьютере инженера, в следствии этого должен относительно хорошо поддерживаться, чтобы не замедлять работу инженеров
* QA контур, может быть несколько, для ручного тестирования, регрессионного, интеграционного, конфигурация ещё ближе к production. Может иметь реплицированные или восстановленные из резервных копий данные с production.
* Staging - практически повторяет по топологии production и его возможности. Все изменения тестируются тут перед тем как попасть на в эксплуатационный контур. Мониторинг, сбор логов и метрик практически всегда обязателен тут. Играет важную роль для эмуляции случаев произошедших в эксплутации и проверке гипотез.
* Producton - он же эксплуатационный контур. Контуров может быть несколько для создания избыточности если она требуется, раскатывают обновления в таком случае последовательно, чтобы иметь возможность быстро переключиться на резерный. Либо избыточный контур находится в другом дата-центре, чтобы иметь возможность обработать отказ всего ДЦ.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_Ссылки">Ссылки</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a id="std610"></a>[std610]  <a href="https://pdfs.semanticscholar.org/dce9/9209120ebed7f5d68e3644fdcd160d4c366c.pdf">IEEE Standard Glossary of Software Engineering Terminology</a></p>
</li>
<li>
<p><a id="hadr"></a>[hadr] High Availability and Disaster Recovery: Concepts, Design, Implementation, (Klaus Schmidt, 2006)</p>
</li>
<li>
<p><a id="cap"></a>[cap] <a href="https://towardsdatascience.com/cap-theorem-and-distributed-database-management-systems-5c2be977950e">CAP Theorem and Distributed Database Management Systems (Syed Sadat Nazrul, 2018)</a></p>
</li>
<li>
<p><a id="wiki_bm"></a>[wiki_bm] <a href="https://en.wikipedia.org/wiki/Benchmark_(computing)">wiki: Benchmark (computing)</a></p>
</li>
<li>
<p><a id="wiki_raid"></a>[wiki_raid] <a href="https://en.wikipedia.org/wiki/RAID">wiki:RAID</a></p>
</li>
<li>
<p><a id="hat"></a>[hat] <a href="https://arxiv.org/abs/1302.0309v2">Highly Available Transactions: Virtues and Limitations
(Extended Version) (Peter Bailis, Aaron Davidson, Alan Fekete, Ali Ghodsi, Joseph M. Hellerstein, Ion Stoica, 2013)</a></p>
</li>
<li>
<p><a id="ds1e"></a>[ds1e] <a href="https://www.elsevier.com/books/distributed-systems/perrin/978-1-78548-226-7">Distributed Systems. Concurrency and Consistency (Matthieu Perrin, 2017)</a></p>
</li>
<li>
<p><a id="pgsql-tr"></a>[pgsql-tr] <a href="https://www.postgresql.org/docs/11/transaction-iso.html">PostgeSQL Documentation. Transaction Isolation</a></p>
</li>
<li>
<p><a id="mssql-si"></a>[mssql-si] <a href="https://docs.microsoft.com/en-us/dotnet/framework/data/adonet/sql/snapshot-isolation-in-sql-server">Snapshot Isolation in SQL Server</a></p>
</li>
<li>
<p><a id="oracle-si"></a>[oracle-si] <a href="https://docs.oracle.com/cd/E17276_01/html/gsg_xml_txn/cxx/isolation.html#snapshot_isolation">Oracle DB. Isolation</a></p>
</li>
<li>
<p><a id="abadi"></a>[abadi] <a href="http://cs-www.cs.yale.edu/homes/dna/papers/abadi-pacelc.pdf">Consistency Tradeoffs in Modern Distributed Database System Design (Yale Univercity, 2012)</a></p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2019-01-23 13:06:38 MSK
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.6.0/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>